<!DOCTYPE html>
<html>
<head>
  <title>Client Messages</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="p-4">

  <div class="container">
    <h2 class="mb-4">ğŸ“© Client Messages</h2>

    <table class="table table-bordered table-striped">
      <thead class="table-primary">
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>Message</th>
          <th>Sent On</th>
        </tr>
      </thead>

      <tbody>
        <% messages.forEach(msg => { %>
          <tr>
            <td><%= msg.name %></td>
            <td><%= msg.email %></td>
            <td><%= msg.message %></td>
            <td><%= msg.formattedDate %></td>
          </tr>
        <% }) %>
      </tbody>

    </table>
  </div>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
document.addEventListener("DOMContentLoaded", () => {
    Swal.fire({
        title: "Admin Access",
        input: "password",
        inputLabel: "Enter Password",
        inputPlaceholder: "Password",
        confirmButtonText: "Submit",
        allowOutsideClick: false,
        preConfirm: async (value) => {
            const res = await fetch("/client_msg/check-password", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ pass: value })
            });

            const data = await res.json();

            if (!data.ok) {
                Swal.showValidationMessage("Incorrect password");
            }
        }
    }).then(result => {
        if (!result.isConfirmed) {
            window.location.href = "/";
        }
    });
});
</script>

</body>
</html>
